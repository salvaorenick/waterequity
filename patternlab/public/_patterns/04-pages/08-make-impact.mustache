{{> organisms-header }}
<div class="container-fluid hero img-bg" style="background-image: url(../../images/impactGirls.jpg)">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-sm-12 center-block text-center">
                <h2 class="color--white ribbon-bg">Make an investment.<br>Make an impact</h2>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-md-8 col-sm-12 center-block text-center container_padding--medium">
            <h2>How your loan works</h2>
            <p>Your investment in WaterEquity funds will unleash the potential of high-growth and purpose-driven enterprises to reach hundreds of millions of people in need of access to improved water and sanitation. Helping to transform lives.</p>
        </div>
    </div>
</div>
<div class="container-fluid container_padding--medium background--light-blue text-center" style="background-color: #82c1ea">
    <div class="row">
        <div class="col-md-12">
            <img class="img-responsive center-block" src="http://waterequity.s3.amazonaws.com/media/filer_public/27/4d/274d4211-b833-43ea-97b2-24ccec0ec7ca/waterloanprocess.png" alt="wataerequity loan process" />
        </div>
    </div>
</div>
<div class="container-fluid container_padding--medium background--xtra-light-blue">
    <h2 class="text-center">Overview and Risks</h2>
    <div class="col-md-8 center-block">
        <div class="media">
            <div class="media-left media-middle">
                <img class="media-object" src="../../images/pipeline.png" alt="Develop the pipeline">
            </div>
            <div class="media-body">
                <h3 class="media-heading brand-dark-blue">Develop the pipeline</h3>
                <p>Building on 13 years of experience with WaterCredit, WaterEquity will identify investment-ready enterprises able to serve the water and sanitation needs of the worldâ€™s poor. This pipeline for investment will include microfinance institutions, product manufacturers and water utilities.</p>
            </div>
        </div>
        <div class="media">
            <div class="media-left media-middle">
                <img class="media-object" src="../../images/unlockCapital.png" alt="Unlock global capital markets ">
            </div>
            <div class="media-body">
                <h3 class="media-heading brand-dark-blue">Unlock global capital markets </h3>
                <p>WaterEquity will connect social impact investors with enterprises that have the potential to reach hundreds of millions of people who lack access to safe water and sanitation.</p>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="container text-center">
            <a class="btn" href="#">Read Full Agreement</a>
        </div>
    </div>
</div>
<div id="make-loan" class="container-fluid container_padding--medium background--light-blue text-center img-bg" style="background-color: #82c1ea; background-image: url(../../images/happyKids.jpg);">
    <div class="row">
        <div class="col-md-8 center-block text-center color--white">
            <img src="../../images/caret_lg.svg" alt="make loan"/>
            <h2>Make a loan today</h2>
            <button class="btn open-form" style="margin-top: -20px">Learn More</button>
            <form id="loanForm" class="form-horizontal text-left center-block" style="margin-top: 80px">
                <div class="form-group row" data-toggle="buttons">
                    <label class="radio-inline radio btn col-xs-1" for="radio-value">
                        <input type="radio" name="amount" id="radio-value" required />
                    </label>
                    <div class="col-xs-3">
                        <input type="text" class="form-control input-value" date-stripe="amount" />
                    </div>
                    <span class="col-xs-6">Loan what you can. It'll help.</span>
                    <br>
                    <label class="radio-inline radio btn col-xs-4" for="50">
                        <input type="radio" id="50" date-stripe="amount" value="220" /> <h2>$220</h2>
                    </label>
                    <span class="col-xs-6">Our lender average per loan.</span>
                </div>
                <div class="form-group row">
                    <div class="col-xs-8">
                        <label>Card Number:</label>
                        <input type="tel"
                            class="form-control cc_number"
                            data-stripe="number"
                            autocomplete="cc-number" />
                    </div>
                    <div class="col-xs-4">
                        <label>Expiration Date:</label>
                        <input class="form-control cc_exp_month"
                            autocomplete="cc-exp-month"
                            placeholder="MM/YY"
                            data-stripe="exp-month"
                            autocomplete="cc-exp" />
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-xs-8">
                        <label>Name on Card:</label>
                        <input type="text"
                            class="form-control name"
                            autocomplete="name"
                            data-stripe="name"
                            required
                            minlength="2" />
                    </div>
                    <div class="col-xs-4">
                        <label>Card Code:</label>
                        <input type="text"
                            class="form-control cvc"
                            data-stripe="cvc"
                            autocomplete="off" />
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-xs-12">
                        <label>Email Address:</label>
                            <input type="email"
                                class="form-control email"
                                autocomplete="email"
                                data-stripe="email-address" />
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-xs-12">
                        <label>Address:</label>
                        <input type="text"
                            class="form-control streetAddress"
                            autocomplete="street-address"
                            placeholder="1 Royal Way"
                            data-stripe="address_line1" />
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-xs-12">
                        <label>City</label>
                        <input type="text"
                            class="form-control address_city"
                            placeholder="Kansas City"
                            data-stripe="address_city" />
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-xs-4">
                        <label>State</label>
                        <input type="text"
                            class="form-control"
                            placeholder="MO"
                            data-stripe="address_state" />
                    </div>
                    <div class="col-xs-4">
                        <label>Zip</label>
                        <input type="text"
                            class="form-control"
                            autocomplete="postal-code"
                            placeholder="64105"
                            data-stripe="address_zip" />
                    </div>
                </div>
                <div class="form-group row" data-toggle="buttons">
                    <p class="col-xs-12"><br>At the close of this loan agreement, I would like my loan principal:<br><br></p>
                    <label class="radio-inline radio btn active" for="relent">
                        <input type="radio" data-stripe="relend" id="relent" value="relent" required checked />
                        <span class="col-xs-10 wrap">to be re-lent, so that my loan capital can recycle to support another loan.</span>
                    </label>
                    <label class="radio-inline radio btn" for="returned">
                        <input type="radio" date-stripe="returned" id="returned" value="returned"/>
                         <span class="col-xs-10">returned to me.</span>
                    </label>
                </div>
                <div class="form-group checkbox row" data-toggle="buttons"style="margin-top: 34px">
                    <label class="btn check-inline check color--white center-block" for="agree">
                      <input type="checkbox" data-stripe="accept-terms" id="agree" />
                      <span class="col-xs-10">I accept the terms of agreement</span>
                    </label>
                </div>
                <div class="form-group text-center ">
                    <input type="submit" class="btn lend" value="Charge my Card" />
                </div>

                <!-- <input type="hidden" name="token" value="" /> -->
            </form>
            <div class="col-md-9 center-block padding-54 background--light-blue color--white thanks">
                <h2>Thank you for your loan</h2>
                <p>Please check your inbox.<br>A confirmation email has been sent.</p>
            </div>

            <!-- <script src="https://js.stripe.com/v2/"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.15.0/jquery.validate.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.15.0/additional-methods.min.js"></script>
            <script>
            $(document).ready(function() {

                var loanForm = $('#loanForm'),
                    today = new Date(),
                    thisYear = today.getFullYear();

                Stripe.setPublishableKey('pk_test_zD30U7Uo8bWMbZXot8UyBkoK');

                $.validator.addMethod('cardNumber', function(value, element, param){
                    return $.payment.validateCardNumber(value);
                }, 'Invalid Card Number');
                //
                // $.validator.addMethod('cardExpiry', function(value, element, param){
                //     return $.payment.validateCardExpiry(param);
                // }, 'Invalid Expiration Date');
                //
                // $.validator.addMethod('cardCVC', function(value, element, param){
                //     return $.payment.validateCardCVC(value, param);
                // }, 'Invalid CVC Number');

                // loanForm.find('input[type=submit]').prop('disabled', true);
                // $( '.terms' ).rules( 'add', {
                //    required: true
                // });
                // $.validator.addClassRules({
                //     terms: {
                //         required: true
                //     },
                //     amount: {
                //         required: true,
                //         min: 1
                //     },
                //     name: {
                //         required: true,
                //         rangelength: [2, 50]
                //     },
                //     email: {
                //         required: true,
                //         email: true
                //     },
                //     street_address: {
                //         // TODO
                //     },
                //     address_city: {
                //         // TODO
                //     },
                //     address_state: {},
                //     address_zip: {},
                //     cc_number: {
                //         required: true,
                //         // creditcard: true,
                //         cardNumber: true
                //     },
                //     cc_exp_month: {
                //         required: true,
                //         rangelength: [1, 2],
                //         digits: true
                //     },
                //     cc_exp_year: {
                //         required: true,
                //         rangelength: [4, 4],
                //         range: [thisYear, thisYear + 20],
                //         digits: true
                //     },
                //     cvc: {
                //         required: true,
                //         minlength: 3,
                //         maxlength: 4
                //     }
                // });

                loanForm.validate({
                    submitHandler: function (form) {
                        console.log("Submitted!");
                        return false;
                    }
                    // ,
                    // submitHandler: function(form) {
                    //     // form.validate(this);
                    //     debugger;
                    //     form.submit(function(e) {
                    //         e.preventDefault();
                    //         var $form = $(e.target);
                    //         $form.find('input[type=submit]').prop('disabled', true);
                    //         // $form.find('[name="token"]').val('');
                    //         Stripe.card.createToken($form, function(status, response) {
                    //             if (response.error) {
                    //                 alert(response.error.message);
                    //             } else {
                    //
                    //                 console.log(response);
                    //                 console.log(status);
                    //                 // Set the token value
                    //                 // $form.find('[name="token"]').val(response.id);
                    //                 //
                    //                 // // You can submit the form to back-end as usual
                    //                 // $form.get(0).success(function(data) {
                    //                 //     // Handle the response
                    //                 //     console.log(data.message);
                    //                 //
                    //                 //     // Reset the form
                    //                 //     // $form.formValidation('resetForm', true);
                    //                 //
                    //                 // });
                    //             }
                    //         });
                    //         return false;
                    //     });
                    //     return false;
                    // }
                });


                // loanForm.submit(function(e) {
                //     e.preventDefault();
                //     var $form = $(e.target);
                //     // $form.find('input[type=submit]').prop('disabled', true);
                //
                //     // Reset the token first
                //     $form.find('[name="token"]').val('');
                //
                //     Stripe.card.createToken($form, function(status, response) {
                //         if (response.error) {
                //             alert(response.error.message);
                //         } else {
                //             debugger;
                //             console.log(response);
                //             console.log(status);
                //             // Set the token value
                //             // $form.find('[name="token"]').val(response.id);
                //             //
                //             // // You can submit the form to back-end as usual
                //             // $form.get(0).success(function(data) {
                //             //     // Handle the response
                //             //     console.log(data.message);
                //             //
                //             //     // Reset the form
                //             //     // $form.formValidation('resetForm', true);
                //             //       loanFormSuccess
                //             //
                //             // });
                //
                //         }
                //     });
                //     return false;
                // });
            });
            </script> -->
        </div>
    </div>
</div>
{{> organisms-footer }}
